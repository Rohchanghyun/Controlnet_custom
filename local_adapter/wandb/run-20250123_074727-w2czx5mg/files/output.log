
2. 데이터 로더 초기화 중...
Loading data from: /workspace/data/changhyun/dataset/pose_attention
Checking directories:
Visual tokens dir: /workspace/data/changhyun/dataset/pose_attention/visual_tokens (exists: True)
Sticker dir: /workspace/data/changhyun/dataset/pose_attention/text_removed_sticker (exists: True)
Sketch dir: /workspace/data/changhyun/dataset/pose_attention/sketch (exists: True)
Found 149813 token files
Found 19190 sticker files
Found 50889 sketch files
Example sketch paths:
 - /workspace/data/changhyun/dataset/pose_attention/sketch/n04482393/sketch_50.JPEG
 - /workspace/data/changhyun/dataset/pose_attention/sketch/n04482393/sketch_49.JPEG
 - /workspace/data/changhyun/dataset/pose_attention/sketch/n04482393/sketch_48.JPEG
Dataset size: 19190 pairs
Total sketch images available: 50889
- 데이터 로더 초기화 후 GPU 메모리: 10.11 GB

3. CUDA 메모리 정리 중...

4. 모델 컴포넌트 GPU 이동 중...
- Text Encoder를 GPU로 이동
  현재 메모리: 10.11 GB
- Text Encoder 2를 GPU로 이동
  현재 메모리: 10.11 GB
- VAE를 GPU로 이동
  현재 메모리: 10.11 GB
- UNet을 GPU로 이동
  현재 메모리: 10.11 GB
- ControlNet을 GPU로 이동
  현재 메모리: 10.11 GB

5. 모델 설정 중...

6. Adapter 초기화 중...
- Image Token Adapter 초기화
  현재 메모리: 10.11 GB
- Visual Token Projector 초기화
  현재 메모리: 10.11 GB
- Cross Attention 모듈 초기화
  현재 메모리: 10.11 GB

=== 학습 초기화 완료 ===
최종 GPU 메모리 사용량: 10.11 GB
남은 GPU 메모리: 40.90 GB
  0%|                                                                                                                                                                                 | 0/19190 [00:00<?, ?it/s]main_controlSDXL.py:664: RuntimeWarning: invalid value encountered in cast

sticker_image shape: torch.Size([1, 3, 768, 768])
  generated_images = Image.fromarray((image * 255).astype(np.uint8))
  0%|                                                                                                                                                                      | 1/19190 [00:13<71:09:20, 13.35s/it]main_controlSDXL.py:664: RuntimeWarning: invalid value encountered in cast
sticker_image shape: torch.Size([1, 3, 768, 768])
  generated_images = Image.fromarray((image * 255).astype(np.uint8))
  0%|                                                                                                                                                                     | 10/19190 [00:25<13:22:25,  2.51s/it]
sticker_image shape: torch.Size([1, 3, 768, 768])
sticker_image shape: torch.Size([1, 3, 768, 768])
sticker_image shape: torch.Size([1, 3, 768, 768])
sticker_image shape: torch.Size([1, 3, 768, 768])
sticker_image shape: torch.Size([1, 3, 768, 768])
sticker_image shape: torch.Size([1, 3, 768, 768])
sticker_image shape: torch.Size([1, 3, 768, 768])
sticker_image shape: torch.Size([1, 3, 768, 768])
sticker_image shape: torch.Size([1, 3, 768, 768])
Traceback (most recent call last):
  File "main_controlSDXL.py", line 815, in <module>
    main.train(epoch=10)  # 테스트 실행
  File "main_controlSDXL.py", line 548, in train
    loss.backward()
  File "/opt/conda/lib/python3.8/site-packages/torch/_tensor.py", line 521, in backward
    torch.autograd.backward(
  File "/opt/conda/lib/python3.8/site-packages/torch/autograd/__init__.py", line 289, in backward
    _engine_run_backward(
  File "/opt/conda/lib/python3.8/site-packages/torch/autograd/graph.py", line 769, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt
